## Темы модуля 03: Как задать условие остановки рассуждения и/или сбора доп. информации

- **Когда задавать вопросы**
  - Если данных недостаточно для корректного заполнения ключей `menu_schema` без домыслов — агент задаёт уточняющие вопросы.
  - Политика вопросов настраивается правилами (например, «1 сообщение — 1 вопрос» или «до 3 вопросов за раз»).

- **Когда завершать**
  - Когда собраны ключевые сведения — агент возвращает ТОЛЬКО JSON по схеме; неизвестное → `null`/пустые массивы.
  - Альтернатива: явный сигнал пользователя («готово», «выдай json», «итоговый») — как дополнительное условие финализации.

- **Передача истории**
  - Вся история (`SESSIONS[chat_id]`) передаётся в контекст: модель видит предыдущие ответы и может планировать следующие вопросы.

- **Пример мини‑диалога (1 сообщение — 1 вопрос)**
  - Пользователь: «Нужен план питания для снижения жира»
  - Агент: «Сколько приёмов пищи в день вам удобно?»
  - Пользователь: «3 в день, на 30 дней»
  - Агент: «Есть ли аллергии или продуктовые ограничения?»
  - Пользователь: «Лактоза»
  - Агент: «Какой диет‑стиль предпочтителен (всеядное/вегетарианское/веганское/кето/палео)?»
  - … далее вопросы до достаточности → финальный JSON по `menu_schema` без комментариев.

- **Подходы к остановке**
  - В промпте (LLM решает сама, следуя правилам) — минимум кода, высокая гибкость.
  - Эвристики в коде (валидация заполненности ключей) — выше контроль, но сложнее логика.

### Источники и материалы
- ReAct (reasoning + acting): [arxiv.org/abs/2210.03629](https://arxiv.org/abs/2210.03629)
- Self‑Ask with Search: [arxiv.org/abs/2210.11919](https://arxiv.org/abs/2210.11919)
- Least‑to‑Most Prompting: [arxiv.org/abs/2210.03493](https://arxiv.org/abs/2210.03493)
- OpenAI Chat/Prompts (контекст и сообщения): [platform.openai.com/docs](https://platform.openai.com/docs)
